generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  parties       Party[]
  subscription  Subscription?
}

model Subscription {
  id        String   @id @default(cuid())
  userId    String   @unique
  plan      PlanType @default(STARTER)
  status    SubscriptionStatus @default(ACTIVE)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

enum PlanType {
  STARTER
  PLUS
  PRO
}

enum SubscriptionStatus {
  ACTIVE
  CANCELLED
  EXPIRED
}

model Party {
  id          String   @id @default(cuid())
  userId      String
  childName   String
  childAge    Int
  interests   String[]
  colors      String[]
  theme       String?
  date        DateTime?
  location    String?
  notes       String?
  status      PartyStatus @default(PLANNING)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  guests      Guest[]
  tasks       Task[]
  budgetItems BudgetItem[]
  
  @@index([userId])
}

enum PartyStatus {
  PLANNING
  CONFIRMED
  COMPLETED
  CANCELLED
}

model Guest {
  id           String    @id @default(cuid())
  partyId      String
  name         String
  email        String?
  phone        String?
  type         GuestType @default(CHILD)
  status       RSVPStatus @default(PENDING)
  dietaryReqs  String?
  isVip        Boolean   @default(false)
  notes        String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  
  party        Party     @relation(fields: [partyId], references: [id], onDelete: Cascade)
  
  @@index([partyId])
}

enum GuestType {
  ADULT
  CHILD
  FAMILY
  COUPLE
}

enum RSVPStatus {
  PENDING
  INVITED
  SENT
  DELIVERED
  OPENED
  RESPONDED
  YES
  NO
  MAYBE
}

model Task {
  id          String    @id @default(cuid())
  partyId     String
  title       String
  description String?
  category    TaskCategory
  dueDate     DateTime?
  completed   Boolean   @default(false)
  completedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  party       Party     @relation(fields: [partyId], references: [id], onDelete: Cascade)
  
  @@index([partyId])
}

enum TaskCategory {
  BOOKING
  SHOPPING
  DECORATIONS
  FOOD
  INVITATIONS
  ENTERTAINMENT
  DAY_OF
}

model BudgetItem {
  id          String   @id @default(cuid())
  partyId     String
  category    String
  item        String
  estimated   Float?
  actual      Float?
  purchased   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  party       Party    @relation(fields: [partyId], references: [id], onDelete: Cascade)
  
  @@index([partyId])
}
